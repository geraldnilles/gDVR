<html>
<head>

<script>

var uid = "";
var status_id = 0;

function get_status(){
	// Reads the status of the stream
	// Will either return idle, preparing, or ready
	// Idle means the tuner aint doing shit
	// Preparing means the tuner has started, but is not ready to stream
	// Ready means the stream is ready to roll
	var s = sync_get("/streamer/status")

	

	return s
}

// Changes the channel and starts the streamer
function change_channel(channel){
	// Stop Video Player
	var ret = sync_get("/streamer/watch/"+channel)

	// Start Status Loop with 2s interval
	status_id = setInterval(status_loop,2000);
}

// Stops the streamer
function stop(){
	var ret = sync_get("/streamer/stop")
	// Stop The Status Loop
	clearInterval(status_is);
}


// Status Loop
//
// This function will regularly poll the status of the streamer at a regular
// interval.  If ready
function status_loop(){
	var s = get_status();
	if (s=="ready"){
		// If already Playing, do nothing
		// Start Playing Video
		// Reduce Status Interval to 10s
		clearInterval(status_id);
		status_id = setInterval(status_loop,10000)
	}else{
		// Print "Tuner is 's'" somewhere on the page	
	}
}

</script>

</head>
<body>

	<h2>Live TV!</h2>

	<div>
		The Tuner is available.  Click Here to take control
	</div>

	<div>
		Choose a channel to watch
	<select>
		<option value="681">ESPN</option>
		<option value="111">FX</option>
		<option value="123">E!</option>
	</select>
	</div>


	<video controls src="/live/out.m3u8"></video>

</body>

</html>

